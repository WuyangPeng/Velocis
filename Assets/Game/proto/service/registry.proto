syntax = "proto3";

package celeritas.proto.service;

message protocol_port {
    int32 protocol = 1;
    int32 port = 2;
}

// 服务注册消息
message register_request {
  string service_name = 1;
  string instance_id = 2;
  string game_server_id = 3;
  string host = 4;
  string external_host = 5;
  repeated protocol_port port = 6;
  int64 start_server_time = 7;
}

message register_response {
}

// 服务发现消息
message discover_request {
  string service_name = 1;
}

message server_info {
    string instance_id = 1;
    string game_server_id = 2;
    string host = 3;
    string external_host = 4;
    repeated protocol_port port = 5;
    int64 start_server_time = 6;
    bool is_health = 7;
}

message discover_response {
  string service_name = 1;
  repeated server_info server_info = 2;
}

// 服务关闭消息
message close_request {
  string instance_id = 1;
}

message service_registry_request {
  oneof payload {
    register_request server_register = 1;
    discover_request server_discover = 2;
    close_request server_close = 3;
  }
}

message service_registry_response {
  oneof payload {
    register_response server_register = 1;
    discover_response server_discover = 2;
  }
}